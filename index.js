'use strict';const _0x2bc2bd=_0x2697;(function(_0xffb21f,_0x2f6036){const _0x52c51f=_0x2697,_0x4a2624=_0xffb21f();while(!![]){try{const _0x58d523=-parseInt(_0x52c51f(0x1b1))/0x1+-parseInt(_0x52c51f(0x1a4))/0x2+-parseInt(_0x52c51f(0x1a9))/0x3+parseInt(_0x52c51f(0x1dd))/0x4+-parseInt(_0x52c51f(0x1dc))/0x5*(parseInt(_0x52c51f(0x1e2))/0x6)+-parseInt(_0x52c51f(0x1b5))/0x7+parseInt(_0x52c51f(0x1b7))/0x8;if(_0x58d523===_0x2f6036)break;else _0x4a2624['push'](_0x4a2624['shift']());}catch(_0x384698){_0x4a2624['push'](_0x4a2624['shift']());}}}(_0x50ac,0x97bd6));function _0x2697(_0x2adc7c,_0x1f8a5d){const _0x50ac59=_0x50ac();return _0x2697=function(_0x26971d,_0x7dadf1){_0x26971d=_0x26971d-0x1a3;let _0x34be8a=_0x50ac59[_0x26971d];return _0x34be8a;},_0x2697(_0x2adc7c,_0x1f8a5d);}var __importDefault=this&&this[_0x2bc2bd(0x1ef)]||function(_0x353b53){const _0x3e9856=_0x2bc2bd;return _0x353b53&&_0x353b53[_0x3e9856(0x1bd)]?_0x353b53:{'default':_0x353b53};};Object[_0x2bc2bd(0x1d2)](exports,'__esModule',{'value':!![]});const global_1=require('./global');require('dotenv')[_0x2bc2bd(0x1ab)]();const bcrypt=require('bcryptjs'),crypto_1=__importDefault(require(_0x2bc2bd(0x1e7))),jwt=require(_0x2bc2bd(0x1ae)),{Pool}=require('pg'),express_1=__importDefault(require('express')),swaggerDocs=require('./swagger/swagger'),cors=require(_0x2bc2bd(0x1cd)),getHealth_1=require(_0x2bc2bd(0x1e3)),getUsers_1=require('./systemFunctions/getUsers'),removeProjectByDate_1=require(_0x2bc2bd(0x1e6));function _0x50ac(){const _0x5c26bc=['license_Info','284402wzauQF','x1.0.0','body','dataBase_host','dataBase_port','2608539XZwdhZ','post','config','rows','env','jsonwebtoken','get','split','271848uZnnZW','Username\x20and\x20password\x20are\x20required','Technology\x20Life\x20Corporation','2024','224931UuHJPj','sign','12082648iowOfk','app_name','/register','JWT_SECRET','Invalid\x20credentials','database_name','__esModule','sonarQube_port','then','Error\x20registering\x20user:','compare','authorization','password','hash','restAPI_port','stack','log','headers','send','Access\x20denied','app_config','SELECT\x20*\x20FROM\x20user_acc\x20WHERE\x20username\x20=\x20$1','cors','Internal\x20server\x20error','/health','default','username:','defineProperty','listen','Internal\x20Server\x20Error','INSERT\x20INTO\x20user_acc\x20(username,\x20password_hash,\x20salt,\x20email,\x20full_name)\x20VALUES\x20($1,\x20$2,\x20$3,\x20$4,\x20$5)\x20RETURNING\x20user_id,\x20username','Protected\x20data','user_id','/license','getUserList','sonar','/deleteProjectByDate','555230DZyzNj','4816848idYoTh','verify','username','password_hash','/users','42YKYCer','./systemFunctions/getHealth','json','Invalid\x20token','./systemFunctions/removeProjectByDate','crypto','status','INSERT\x20INTO\x20user_login\x20(user_id)\x20VALUES\x20($1)','Username\x20already\x20registered','POST','Something\x20went\x20wrong!','query','/protected','__importDefault','checkSonarQubeHealth','use'];_0x50ac=function(){return _0x5c26bc;};return _0x50ac();}async function getConfig(){const _0x255838=_0x2bc2bd;try{const _0x3ffd2c=await global_1[_0x255838(0x1cb)];return _0x3ffd2c;}catch(_0x2acd76){console['error']('Error\x20fetching\x20config:',_0x2acd76);}}const app=(0x0,express_1['default'])();app[_0x2bc2bd(0x1f1)](express_1[_0x2bc2bd(0x1d0)][_0x2bc2bd(0x1e4)]()),app['use'](cors()),app[_0x2bc2bd(0x1f1)]((_0x5316a5,_0x2f2207,_0x4ecfe7,_0x34b20a)=>{const _0x28d6fb=_0x2bc2bd;console['error'](_0x5316a5[_0x28d6fb(0x1c6)]),_0x4ecfe7[_0x28d6fb(0x1e8)](_0x5316a5['status']||0x1f4)[_0x28d6fb(0x1e4)]({'success':![],'message':_0x5316a5['message']||_0x28d6fb(0x1d4)});});async function main(_0x5ef017){rest_api(_0x5ef017);}async function rest_api(_0xc6786b){const _0x2fdfad=_0x2bc2bd,_0x6be8d=(0x0,express_1[_0x2fdfad(0x1d0)])(),_0x1c340a=process['env'][_0x2fdfad(0x1eb)]??_0xc6786b[_0x2fdfad(0x1c5)];_0x6be8d[_0x2fdfad(0x1f1)](express_1[_0x2fdfad(0x1d0)][_0x2fdfad(0x1e4)]());function _0x4c2bd6(_0x33aa57){const _0x249339=_0x2fdfad;return new Pool({'user':_0x33aa57['dataBase_user']||_0x249339(0x1da),'host':_0x33aa57[_0x249339(0x1a7)]||'','database':_0x33aa57[_0x249339(0x1bc)]||'SonarControlPanel','password':_0x33aa57['database_password']||_0x249339(0x1c3),'port':_0x33aa57[_0x249339(0x1a8)]||0x1538,'acquireTimeout':0x2710});}function _0x10df7f(_0x5368b6){const _0x2113da=_0x2fdfad;console[_0x2113da(0x1c7)](_0x5368b6);if(!_0x5368b6)return![];else jwt[_0x2113da(0x1de)](_0x5368b6,process['env']['JWT_SECRET'],async(_0x110b08,_0x540ac4)=>{if(_0x110b08)return![];return!![];});}_0x6be8d['get']('/',(_0x37c1f3,_0x118592)=>{const _0x42355b=_0x2fdfad;_0x118592[_0x42355b(0x1c9)]({'version':_0x42355b(0x1a5),'app_name':_0xc6786b[_0x42355b(0x1b8)],'company_author':_0x42355b(0x1b3),'copyright':_0x42355b(0x1b4)});}),_0x6be8d[_0x2fdfad(0x1af)](_0x2fdfad(0x1cf),async(_0x4ebbfd,_0x5159d8)=>{const _0x4025ad=_0x2fdfad,_0x14047a=_0xc6786b['sonarQube_server']+':'+_0xc6786b[_0x4025ad(0x1be)];try{const _0x52526c=await(0x0,getHealth_1[_0x4025ad(0x1f0)])(_0x14047a);_0x52526c?_0x5159d8[_0x4025ad(0x1e4)]({'status':!![]}):_0x5159d8[_0x4025ad(0x1e4)]({'status':![]});}catch(_0x2a5ea7){_0x5159d8['status'](0x1f4)[_0x4025ad(0x1e4)]({'error':_0x4025ad(0x1ce)});}}),_0x6be8d[_0x2fdfad(0x1af)](_0x2fdfad(0x1d8),async(_0x3e6598,_0x2a312e)=>{const _0x335d=_0x2fdfad;return _0x2a312e[_0x335d(0x1e8)](0xc8)['send'](await global_1[_0x335d(0x1a3)]);}),_0x6be8d['post'](_0x2fdfad(0x1b9),async(_0x3c9ac0,_0x37626f)=>{const _0x5500e7=_0x2fdfad;let _0x31e0d6=_0x4c2bd6(_0xc6786b);const {username:_0x39f920,password:_0x3debab,email:_0x5c3c08,full_name:_0x62c084}=_0x3c9ac0[_0x5500e7(0x1a6)];console[_0x5500e7(0x1c7)](_0x3c9ac0['body']);if(!_0x39f920||!_0x3debab)return _0x37626f[_0x5500e7(0x1e8)](0x190)['send'](_0x5500e7(0x1b2));try{console[_0x5500e7(0x1c7)](_0x5500e7(0x1d1),[_0x39f920]);const _0x430b52=await _0x31e0d6[_0x5500e7(0x1ed)]('SELECT\x20*\x20FROM\x20user_acc\x20Where\x20username\x20=\x20$1',[_0x39f920]);if(_0x430b52['rowCount'])return _0x37626f['status'](0x190)[_0x5500e7(0x1c9)](_0x5500e7(0x1ea));}catch(_0x4962d0){console[_0x5500e7(0x1c7)](_0x4962d0);throw new Error(_0x5500e7(0x1ec));}try{const _0x3ae944=crypto_1[_0x5500e7(0x1d0)]['randomBytes'](0x10)['toString']('hex'),_0xd67ada=_0x3debab+_0x3ae944,_0x8cef85=await bcrypt[_0x5500e7(0x1c4)](_0x3debab,0xc),_0x26f200=await _0x31e0d6[_0x5500e7(0x1ed)](_0x5500e7(0x1d5),[_0x39f920,_0x8cef85,_0xd67ada,_0x5c3c08,_0x62c084]),_0x58ce61=_0x26f200[_0x5500e7(0x1ac)][0x0];_0x37626f[_0x5500e7(0x1e8)](0xc9)['json']({'id':_0x58ce61[_0x5500e7(0x1d7)],'username':_0x58ce61[_0x5500e7(0x1df)]});}catch(_0x1c56da){console['error'](_0x5500e7(0x1c0),_0x1c56da),_0x37626f[_0x5500e7(0x1e8)](0x1f4)['send'](_0x5500e7(0x1ce));}}),_0x6be8d[_0x2fdfad(0x1aa)]('/login',async(_0x384b18,_0x467cd8)=>{const _0x573c8d=_0x2fdfad;let _0x416732=_0x4c2bd6(_0xc6786b);const {username:_0x2cdded,password:_0xb4daa9}=_0x384b18['body'];if(!_0x2cdded||!_0xb4daa9)return _0x467cd8[_0x573c8d(0x1e8)](0x190)[_0x573c8d(0x1c9)](_0x573c8d(0x1b2));try{const _0x27f12f=await _0x416732[_0x573c8d(0x1ed)](_0x573c8d(0x1cc),[_0x2cdded]),_0x350add=_0x27f12f['rows'][0x0];if(!_0x350add)return _0x467cd8[_0x573c8d(0x1e8)](0x191)[_0x573c8d(0x1c9)](_0x573c8d(0x1bb));const _0x5b309c=_0xb4daa9+_0x350add['salt'],_0x2d568d=await bcrypt[_0x573c8d(0x1c1)](_0xb4daa9,_0x350add[_0x573c8d(0x1e0)]);if(!_0x2d568d)return _0x467cd8[_0x573c8d(0x1e8)](0x191)[_0x573c8d(0x1c9)]('Invalid\x20credentials');const _0x59077f=jwt[_0x573c8d(0x1b6)]({'userId':_0x350add[_0x573c8d(0x1d7)],'username':_0x350add['username']},process['env'][_0x573c8d(0x1ba)],{'expiresIn':'1h'});_0x59077f&&await _0x416732[_0x573c8d(0x1ed)](_0x573c8d(0x1e9),[_0x350add[_0x573c8d(0x1d7)]]),_0x467cd8[_0x573c8d(0x1e4)]({'token':_0x59077f});}catch(_0x1af1aa){console['log'](_0x1af1aa),_0x467cd8[_0x573c8d(0x1e8)](0x1f4)[_0x573c8d(0x1c9)](_0x1af1aa);throw new Error(_0x573c8d(0x1ec));}}),_0x6be8d[_0x2fdfad(0x1af)](_0x2fdfad(0x1e1),async(_0x4aed1b,_0xc44a20)=>{const _0x433bdf=_0x2fdfad;try{const _0x8f57eb=_0x4aed1b[_0x433bdf(0x1c8)][_0x433bdf(0x1c2)]?.[_0x433bdf(0x1b0)]('\x20')[0x1];if(!_0x8f57eb)return _0xc44a20[_0x433bdf(0x1e8)](0x193)[_0x433bdf(0x1c9)]('Access\x20denied');jwt[_0x433bdf(0x1de)](_0x8f57eb,process[_0x433bdf(0x1ad)][_0x433bdf(0x1ba)],async(_0xab1f2e,_0x519b6d)=>{const _0x49bbce=_0x433bdf;if(_0xab1f2e)return _0xc44a20[_0x49bbce(0x1e8)](0x193)[_0x49bbce(0x1c9)](_0x49bbce(0x1e5));const _0x3a9f3a=await(0x0,getUsers_1[_0x49bbce(0x1d9)])(_0xc6786b);_0xc44a20[_0x49bbce(0x1e4)](_0x3a9f3a);});}catch(_0x335726){return _0xc44a20[_0x433bdf(0x1e8)](0x1f4)[_0x433bdf(0x1c9)](_0x335726);}}),_0x6be8d[_0x2fdfad(0x1aa)](_0x2fdfad(0x1db),async(_0x2787bb,_0x357244)=>{const _0x142c2b=_0x2fdfad,{beforeDate:_0x4867bd}=_0x2787bb['body'],_0x5c62c8=await(0x0,removeProjectByDate_1['deleteProjectsBeforeDate'])(_0xc6786b,_0x4867bd);_0x357244[_0x142c2b(0x1e4)](_0x5c62c8);}),_0x6be8d['get'](_0x2fdfad(0x1ee),(_0x4749bb,_0x31d342)=>{const _0x27278=_0x2fdfad,_0x5d6d94=_0x4749bb[_0x27278(0x1c8)][_0x27278(0x1c2)]?.[_0x27278(0x1b0)]('\x20')[0x1];if(!_0x5d6d94)return _0x31d342[_0x27278(0x1e8)](0x193)[_0x27278(0x1c9)](_0x27278(0x1ca));jwt[_0x27278(0x1de)](_0x5d6d94,process[_0x27278(0x1ad)][_0x27278(0x1ba)],(_0x42fdd7,_0x4b0b47)=>{const _0x470c38=_0x27278;if(_0x42fdd7)return _0x31d342['status'](0x193)['send'](_0x470c38(0x1e5));_0x31d342[_0x470c38(0x1e4)]({'message':_0x470c38(0x1d6),'user':_0x4b0b47});});}),_0x6be8d[_0x2fdfad(0x1d3)](_0x1c340a,()=>{const _0x172590=_0x2fdfad;console[_0x172590(0x1c7)]('Server\x20is\x20running\x20on\x20port\x20'+_0x1c340a),swaggerDocs(_0x6be8d,_0x1c340a);});}getConfig()[_0x2bc2bd(0x1bf)](function(_0x2345d9){main(_0x2345d9);});